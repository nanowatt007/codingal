-- Create

CREATE TABLE IF NOT EXISTS SALESMEN (
ID TEXT PRIMARY KEY,
NAME TEXT NOT NULL,
CITY TEXT NOT NULL,
COMMISION REAL NOT NULL
);

CREATE TABLE IF NOT EXISTS CUSTOMERS (
ID TEXT PRIMARY KEY,
NAME TEXT NOT NULL,
CITY TEXT NOT NULL,
GRADE INTEGER NOT NULL,
SALESMAN_ID TEXT NOT NULL,
FOREIGN KEY (SALESMAN_ID) REFERENCES SALESMEN(ID)
);

CREATE TABLE IF NOT EXISTS ORDERS (
NUM TEXT PRIMARY KEY,
PURCHASE_AMOUNT REAL NOT NULL,
ORDER_DATE TEXT NOT NULL,
CUSTOMER_ID TEXT NOT NULL,
SALESMAN_ID TEXT NOT NULL,
FOREIGN KEY (SALESMAN_ID) REFERENCES SALESMEN(ID),
FOREIGN KEY (CUSTOMER_ID) REFERENCES CUSTOMERS(ID)
);


-- Insert

INSERT INTO SALESMEN (ID, NAME, CITY, COMMISION) VALUES
('S001', 'John Doe', 'New York', 0.10),
('S002', 'Jane Smith', 'Los Angeles', 0.15),
('S003', 'Alice Johnson', 'Chicago', 0.12),
('S004', 'Star Williams', 'Toronto', 0.16);

INSERT INTO CUSTOMERS (ID, NAME, CITY, GRADE, SALESMAN_ID) VALUES
('C001', 'Acme Corp', 'New York', 1, 'S001'),
('C002', 'Beta LLC', 'Los Angeles', 2, 'S002'),
('C003', 'Gamma Inc', 'Chicago', 3, 'S003'),
('C004', 'Delta Ltd', 'Toronto', 1, 'S003');

INSERT INTO ORDERS (NUM, PURCHASE_AMOUNT, ORDER_DATE, CUSTOMER_ID, SALESMAN_ID) VALUES
('O001', 1500.00, '2023-01-15', 'C001', 'S001'),
('O002', 2500.00, '2023-02-20', 'C002', 'S002'),
('O003', 3000.00, '2023-03-10', 'C003', 'S003'),
('O004', 2000.00, '2023-04-05', 'C004', 'S003');


-- Select

SELECT
CUSTOMERS.NAME AS 'Customer Name',
SALESMEN.NAME AS 'Salesman Name',
SALESMEN.CITY AS 'CITY'
FROM CUSTOMERS
JOIN SALESMEN ON CUSTOMERS.SALESMAN_ID = SALESMEN.ID;

SELECT ORDERS.NUM, CUSTOMERS.NAME, ORDERS.CUSTOMER_ID, ORDERS.SALESMAN_ID
FROM ORDERS
JOIN CUSTOMERS ON ORDERS.CUSTOMER_ID = CUSTOMERS.ID
JOIN SALESMEN ON ORDERS.SALESMAN_ID = SALESMEN.ID
WHERE CUSTOMERS.CITY <> SALESMEN.CITY AND CUSTOMERS.GRADE IS NOT NULL;

SELECT CUSTOMERS.ID AS 'Customer ID', ORDERS.NUM AS 'Order Number'
FROM CUSTOMERS
JOIN ORDERS ON CUSTOMERS.ID = ORDERS.CUSTOMER_ID;
